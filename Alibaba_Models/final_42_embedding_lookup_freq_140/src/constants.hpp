#pragma once
#include <ap_int.h>

//////////////////////////////   TEMPLATE START  //////////////////////////////

#define AXI_WIDTH_PLRAM 32
#define AXI_WIDTH_HBM 32
#define AXI_WIDTH_DDR 32

#define INT_BITS 32
#define INTS_PER_AXI_PLRAM 1
#define INTS_PER_AXI_HBM 1
#define INTS_PER_AXI_DDR 1

#define PLRAM_BANK_NUM 4
#define HBM_BANK_NUM 32
#define DDR_BANK 2

#define TABLE_NUM 42

// #define ACCESS_IDX_SIZE 42
// #define PADDED_ACCESS_IDX_SIZE 42
// #define AXI_PADDED_ACCESS_IDX_SIZE 42

#define TABLE_NUM_HBM 32
#define TABLE_NUM_DDR 2
#define TABLE_NUM_PLRAM 8

/////////////////////////   HBM   ///////////////////////// 
// alignment of tables to HBM: 
// table 0 ~ 31 -> HBM 0 ~ 31
// table 32 ~ 63 -> HBM 0 ~ 31

#define DATA_SIZE_HBM_0 8
#define PADDED_SIZE_HBM_0 8
#define AXI_PADDED_SIZE_HBM_0 8
#define TABLE_SIZE_HBM_0 10000
#define DATA_SIZE_HBM_1 8
#define PADDED_SIZE_HBM_1 8
#define AXI_PADDED_SIZE_HBM_1 8
#define TABLE_SIZE_HBM_1 10000
#define DATA_SIZE_HBM_2 8
#define PADDED_SIZE_HBM_2 8
#define AXI_PADDED_SIZE_HBM_2 8
#define TABLE_SIZE_HBM_2 10000
#define DATA_SIZE_HBM_3 8
#define PADDED_SIZE_HBM_3 8
#define AXI_PADDED_SIZE_HBM_3 8
#define TABLE_SIZE_HBM_3 10000
#define DATA_SIZE_HBM_4 8
#define PADDED_SIZE_HBM_4 8
#define AXI_PADDED_SIZE_HBM_4 8
#define TABLE_SIZE_HBM_4 10000
#define DATA_SIZE_HBM_5 8
#define PADDED_SIZE_HBM_5 8
#define AXI_PADDED_SIZE_HBM_5 8
#define TABLE_SIZE_HBM_5 10000
#define DATA_SIZE_HBM_6 8
#define PADDED_SIZE_HBM_6 8
#define AXI_PADDED_SIZE_HBM_6 8
#define TABLE_SIZE_HBM_6 10000
#define DATA_SIZE_HBM_7 8
#define PADDED_SIZE_HBM_7 8
#define AXI_PADDED_SIZE_HBM_7 8
#define TABLE_SIZE_HBM_7 10000
#define DATA_SIZE_HBM_8 8
#define PADDED_SIZE_HBM_8 8
#define AXI_PADDED_SIZE_HBM_8 8
#define TABLE_SIZE_HBM_8 10000
#define DATA_SIZE_HBM_9 8
#define PADDED_SIZE_HBM_9 8
#define AXI_PADDED_SIZE_HBM_9 8
#define TABLE_SIZE_HBM_9 10000
#define DATA_SIZE_HBM_10 8
#define PADDED_SIZE_HBM_10 8
#define AXI_PADDED_SIZE_HBM_10 8
#define TABLE_SIZE_HBM_10 10000
#define DATA_SIZE_HBM_11 8
#define PADDED_SIZE_HBM_11 8
#define AXI_PADDED_SIZE_HBM_11 8
#define TABLE_SIZE_HBM_11 10000
#define DATA_SIZE_HBM_12 8
#define PADDED_SIZE_HBM_12 8
#define AXI_PADDED_SIZE_HBM_12 8
#define TABLE_SIZE_HBM_12 20000
#define DATA_SIZE_HBM_13 8
#define PADDED_SIZE_HBM_13 8
#define AXI_PADDED_SIZE_HBM_13 8
#define TABLE_SIZE_HBM_13 30000
#define DATA_SIZE_HBM_14 8
#define PADDED_SIZE_HBM_14 8
#define AXI_PADDED_SIZE_HBM_14 8
#define TABLE_SIZE_HBM_14 100000
#define DATA_SIZE_HBM_15 8
#define PADDED_SIZE_HBM_15 8
#define AXI_PADDED_SIZE_HBM_15 8
#define TABLE_SIZE_HBM_15 100000
#define DATA_SIZE_HBM_16 8
#define PADDED_SIZE_HBM_16 8
#define AXI_PADDED_SIZE_HBM_16 8
#define TABLE_SIZE_HBM_16 100000
#define DATA_SIZE_HBM_17 8
#define PADDED_SIZE_HBM_17 8
#define AXI_PADDED_SIZE_HBM_17 8
#define TABLE_SIZE_HBM_17 100000
#define DATA_SIZE_HBM_18 8
#define PADDED_SIZE_HBM_18 8
#define AXI_PADDED_SIZE_HBM_18 8
#define TABLE_SIZE_HBM_18 100000
#define DATA_SIZE_HBM_19 8
#define PADDED_SIZE_HBM_19 8
#define AXI_PADDED_SIZE_HBM_19 8
#define TABLE_SIZE_HBM_19 100000
#define DATA_SIZE_HBM_20 8
#define PADDED_SIZE_HBM_20 8
#define AXI_PADDED_SIZE_HBM_20 8
#define TABLE_SIZE_HBM_20 100000
#define DATA_SIZE_HBM_21 8
#define PADDED_SIZE_HBM_21 8
#define AXI_PADDED_SIZE_HBM_21 8
#define TABLE_SIZE_HBM_21 100000
#define DATA_SIZE_HBM_22 8
#define PADDED_SIZE_HBM_22 8
#define AXI_PADDED_SIZE_HBM_22 8
#define TABLE_SIZE_HBM_22 100000
#define DATA_SIZE_HBM_23 8
#define PADDED_SIZE_HBM_23 8
#define AXI_PADDED_SIZE_HBM_23 8
#define TABLE_SIZE_HBM_23 100000
#define DATA_SIZE_HBM_24 8
#define PADDED_SIZE_HBM_24 8
#define AXI_PADDED_SIZE_HBM_24 8
#define TABLE_SIZE_HBM_24 100000
#define DATA_SIZE_HBM_25 8
#define PADDED_SIZE_HBM_25 8
#define AXI_PADDED_SIZE_HBM_25 8
#define TABLE_SIZE_HBM_25 100000
#define DATA_SIZE_HBM_26 8
#define PADDED_SIZE_HBM_26 8
#define AXI_PADDED_SIZE_HBM_26 8
#define TABLE_SIZE_HBM_26 100000
#define DATA_SIZE_HBM_27 8
#define PADDED_SIZE_HBM_27 8
#define AXI_PADDED_SIZE_HBM_27 8
#define TABLE_SIZE_HBM_27 100000
#define DATA_SIZE_HBM_28 8
#define PADDED_SIZE_HBM_28 8
#define AXI_PADDED_SIZE_HBM_28 8
#define TABLE_SIZE_HBM_28 500000
#define DATA_SIZE_HBM_29 8
#define PADDED_SIZE_HBM_29 8
#define AXI_PADDED_SIZE_HBM_29 8
#define TABLE_SIZE_HBM_29 500000
#define DATA_SIZE_HBM_30 16
#define PADDED_SIZE_HBM_30 16
#define AXI_PADDED_SIZE_HBM_30 16
#define TABLE_SIZE_HBM_30 500000
#define DATA_SIZE_HBM_31 16
#define PADDED_SIZE_HBM_31 16
#define AXI_PADDED_SIZE_HBM_31 16
#define TABLE_SIZE_HBM_31 1000000

#define BURST_SIZE_HBM 16

#define ADDR_AXI_HBM_0 0
#define ADDR_AXI_HBM_1 0
#define ADDR_AXI_HBM_2 0
#define ADDR_AXI_HBM_3 0
#define ADDR_AXI_HBM_4 0
#define ADDR_AXI_HBM_5 0
#define ADDR_AXI_HBM_6 0
#define ADDR_AXI_HBM_7 0
#define ADDR_AXI_HBM_8 0
#define ADDR_AXI_HBM_9 0
#define ADDR_AXI_HBM_10 0
#define ADDR_AXI_HBM_11 0
#define ADDR_AXI_HBM_12 0
#define ADDR_AXI_HBM_13 0
#define ADDR_AXI_HBM_14 0
#define ADDR_AXI_HBM_15 0
#define ADDR_AXI_HBM_16 0
#define ADDR_AXI_HBM_17 0
#define ADDR_AXI_HBM_18 0
#define ADDR_AXI_HBM_19 0
#define ADDR_AXI_HBM_20 0
#define ADDR_AXI_HBM_21 0
#define ADDR_AXI_HBM_22 0
#define ADDR_AXI_HBM_23 0
#define ADDR_AXI_HBM_24 0
#define ADDR_AXI_HBM_25 0
#define ADDR_AXI_HBM_26 0
#define ADDR_AXI_HBM_27 0
#define ADDR_AXI_HBM_28 0
#define ADDR_AXI_HBM_29 0
#define ADDR_AXI_HBM_30 0
#define ADDR_AXI_HBM_31 0

#define HBM_BANK0_ROUND 1
#define HBM_BANK1_ROUND 1
#define HBM_BANK2_ROUND 1
#define HBM_BANK3_ROUND 1
#define HBM_BANK4_ROUND 1
#define HBM_BANK5_ROUND 1
#define HBM_BANK6_ROUND 1
#define HBM_BANK7_ROUND 1
#define HBM_BANK8_ROUND 1
#define HBM_BANK9_ROUND 1
#define HBM_BANK10_ROUND 1
#define HBM_BANK11_ROUND 1
#define HBM_BANK12_ROUND 1
#define HBM_BANK13_ROUND 1
#define HBM_BANK14_ROUND 1
#define HBM_BANK15_ROUND 1
#define HBM_BANK16_ROUND 1
#define HBM_BANK17_ROUND 1
#define HBM_BANK18_ROUND 1
#define HBM_BANK19_ROUND 1
#define HBM_BANK20_ROUND 1
#define HBM_BANK21_ROUND 1
#define HBM_BANK22_ROUND 1
#define HBM_BANK23_ROUND 1
#define HBM_BANK24_ROUND 1
#define HBM_BANK25_ROUND 1
#define HBM_BANK26_ROUND 1
#define HBM_BANK27_ROUND 1
#define HBM_BANK28_ROUND 1
#define HBM_BANK29_ROUND 1
#define HBM_BANK30_ROUND 1
#define HBM_BANK31_ROUND 1

#define HBM_BANK0_SIZE 80000
#define HBM_BANK1_SIZE 80000
#define HBM_BANK2_SIZE 80000
#define HBM_BANK3_SIZE 80000
#define HBM_BANK4_SIZE 80000
#define HBM_BANK5_SIZE 80000
#define HBM_BANK6_SIZE 80000
#define HBM_BANK7_SIZE 80000
#define HBM_BANK8_SIZE 80000
#define HBM_BANK9_SIZE 80000
#define HBM_BANK10_SIZE 80000
#define HBM_BANK11_SIZE 80000
#define HBM_BANK12_SIZE 160000
#define HBM_BANK13_SIZE 240000
#define HBM_BANK14_SIZE 800000
#define HBM_BANK15_SIZE 800000
#define HBM_BANK16_SIZE 800000
#define HBM_BANK17_SIZE 800000
#define HBM_BANK18_SIZE 800000
#define HBM_BANK19_SIZE 800000
#define HBM_BANK20_SIZE 800000
#define HBM_BANK21_SIZE 800000
#define HBM_BANK22_SIZE 800000
#define HBM_BANK23_SIZE 800000
#define HBM_BANK24_SIZE 800000
#define HBM_BANK25_SIZE 800000
#define HBM_BANK26_SIZE 800000
#define HBM_BANK27_SIZE 800000
#define HBM_BANK28_SIZE 4000000
#define HBM_BANK29_SIZE 4000000
#define HBM_BANK30_SIZE 8000000
#define HBM_BANK31_SIZE 16000000

#define VECTOR_SIZE_HBM_BANK_0 8
#define VECTOR_SIZE_HBM_BANK_1 8
#define VECTOR_SIZE_HBM_BANK_2 8
#define VECTOR_SIZE_HBM_BANK_3 8
#define VECTOR_SIZE_HBM_BANK_4 8
#define VECTOR_SIZE_HBM_BANK_5 8
#define VECTOR_SIZE_HBM_BANK_6 8
#define VECTOR_SIZE_HBM_BANK_7 8
#define VECTOR_SIZE_HBM_BANK_8 8
#define VECTOR_SIZE_HBM_BANK_9 8
#define VECTOR_SIZE_HBM_BANK_10 8
#define VECTOR_SIZE_HBM_BANK_11 8
#define VECTOR_SIZE_HBM_BANK_12 8
#define VECTOR_SIZE_HBM_BANK_13 8
#define VECTOR_SIZE_HBM_BANK_14 8
#define VECTOR_SIZE_HBM_BANK_15 8
#define VECTOR_SIZE_HBM_BANK_16 8
#define VECTOR_SIZE_HBM_BANK_17 8
#define VECTOR_SIZE_HBM_BANK_18 8
#define VECTOR_SIZE_HBM_BANK_19 8
#define VECTOR_SIZE_HBM_BANK_20 8
#define VECTOR_SIZE_HBM_BANK_21 8
#define VECTOR_SIZE_HBM_BANK_22 8
#define VECTOR_SIZE_HBM_BANK_23 8
#define VECTOR_SIZE_HBM_BANK_24 8
#define VECTOR_SIZE_HBM_BANK_25 8
#define VECTOR_SIZE_HBM_BANK_26 8
#define VECTOR_SIZE_HBM_BANK_27 8
#define VECTOR_SIZE_HBM_BANK_28 8
#define VECTOR_SIZE_HBM_BANK_29 8
#define VECTOR_SIZE_HBM_BANK_30 16
#define VECTOR_SIZE_HBM_BANK_31 16

#define VECTOR_START_IDX_HBM_BANK_0 0
#define VECTOR_START_IDX_HBM_BANK_1 8
#define VECTOR_START_IDX_HBM_BANK_2 16
#define VECTOR_START_IDX_HBM_BANK_3 24
#define VECTOR_START_IDX_HBM_BANK_4 32
#define VECTOR_START_IDX_HBM_BANK_5 40
#define VECTOR_START_IDX_HBM_BANK_6 48
#define VECTOR_START_IDX_HBM_BANK_7 56
#define VECTOR_START_IDX_HBM_BANK_8 64
#define VECTOR_START_IDX_HBM_BANK_9 72
#define VECTOR_START_IDX_HBM_BANK_10 80
#define VECTOR_START_IDX_HBM_BANK_11 88
#define VECTOR_START_IDX_HBM_BANK_12 96
#define VECTOR_START_IDX_HBM_BANK_13 104
#define VECTOR_START_IDX_HBM_BANK_14 112
#define VECTOR_START_IDX_HBM_BANK_15 120
#define VECTOR_START_IDX_HBM_BANK_16 128
#define VECTOR_START_IDX_HBM_BANK_17 136
#define VECTOR_START_IDX_HBM_BANK_18 144
#define VECTOR_START_IDX_HBM_BANK_19 152
#define VECTOR_START_IDX_HBM_BANK_20 160
#define VECTOR_START_IDX_HBM_BANK_21 168
#define VECTOR_START_IDX_HBM_BANK_22 176
#define VECTOR_START_IDX_HBM_BANK_23 184
#define VECTOR_START_IDX_HBM_BANK_24 192
#define VECTOR_START_IDX_HBM_BANK_25 200
#define VECTOR_START_IDX_HBM_BANK_26 208
#define VECTOR_START_IDX_HBM_BANK_27 216
#define VECTOR_START_IDX_HBM_BANK_28 224
#define VECTOR_START_IDX_HBM_BANK_29 232
#define VECTOR_START_IDX_HBM_BANK_30 240
#define VECTOR_START_IDX_HBM_BANK_31 256

/////////////////////////   DDR   ///////////////////////// 
// alignment of tables to DDR: 
// table 0 ~ 1 -> DDR 0 ~ 1
// table 2 ~ 3 -> DDR 0 ~ 1

#define DATA_SIZE_DDR_0 16
#define PADDED_SIZE_DDR_0 16
#define AXI_PADDED_SIZE_DDR_0 16
#define TABLE_SIZE_DDR_0 10000000
#define DATA_SIZE_DDR_1 16
#define PADDED_SIZE_DDR_1 16
#define AXI_PADDED_SIZE_DDR_1 16
#define TABLE_SIZE_DDR_1 10000000

#define BURST_SIZE_DDR 16

#define ADDR_AXI_DDR_0 0
#define ADDR_AXI_DDR_1 0

#define DDR_BANK0_ROUND 1
#define DDR_BANK1_ROUND 1

#define DDR_BANK0_SIZE 160000000
#define DDR_BANK1_SIZE 160000000

#define VECTOR_SIZE_DDR_BANK_0 16
#define VECTOR_SIZE_DDR_BANK_1 16

#define VECTOR_START_IDX_DDR_BANK_0 272
#define VECTOR_START_IDX_DDR_BANK_1 288

/////////////////////////   PLRAM   ///////////////////////// 
// alignment of tables to PLRAM: 
// table 0 ~ 3 -> PLRAM 0 ~ 3
// table 4 ~ 7 -> PLRAM 0 ~ 3

#define DATA_SIZE_PLRAM_0 4
#define PADDED_SIZE_PLRAM_0 4
#define AXI_PADDED_SIZE_PLRAM_0 4
#define TABLE_SIZE_PLRAM_0 1000
#define DATA_SIZE_PLRAM_1 4
#define PADDED_SIZE_PLRAM_1 4
#define AXI_PADDED_SIZE_PLRAM_1 4
#define TABLE_SIZE_PLRAM_1 1000
#define DATA_SIZE_PLRAM_2 4
#define PADDED_SIZE_PLRAM_2 4
#define AXI_PADDED_SIZE_PLRAM_2 4
#define TABLE_SIZE_PLRAM_2 1000
#define DATA_SIZE_PLRAM_3 4
#define PADDED_SIZE_PLRAM_3 4
#define AXI_PADDED_SIZE_PLRAM_3 4
#define TABLE_SIZE_PLRAM_3 1000
#define DATA_SIZE_PLRAM_4 8
#define PADDED_SIZE_PLRAM_4 8
#define AXI_PADDED_SIZE_PLRAM_4 8
#define TABLE_SIZE_PLRAM_4 3000
#define DATA_SIZE_PLRAM_5 8
#define PADDED_SIZE_PLRAM_5 8
#define AXI_PADDED_SIZE_PLRAM_5 8
#define TABLE_SIZE_PLRAM_5 10000
#define DATA_SIZE_PLRAM_6 8
#define PADDED_SIZE_PLRAM_6 8
#define AXI_PADDED_SIZE_PLRAM_6 8
#define TABLE_SIZE_PLRAM_6 10000
#define DATA_SIZE_PLRAM_7 8
#define PADDED_SIZE_PLRAM_7 8
#define AXI_PADDED_SIZE_PLRAM_7 8
#define TABLE_SIZE_PLRAM_7 10000

#define BURST_SIZE_PLRAM 8

#define ADDR_AXI_PLRAM_0 0
#define ADDR_AXI_PLRAM_1 0
#define ADDR_AXI_PLRAM_2 0
#define ADDR_AXI_PLRAM_3 0
#define ADDR_AXI_PLRAM_4 4000
#define ADDR_AXI_PLRAM_5 4000
#define ADDR_AXI_PLRAM_6 4000
#define ADDR_AXI_PLRAM_7 4000

#define PLRAM_BANK0_ROUND 2
#define PLRAM_BANK1_ROUND 2
#define PLRAM_BANK2_ROUND 2
#define PLRAM_BANK3_ROUND 2

#define PLRAM_BANK0_SIZE 28000
#define PLRAM_BANK1_SIZE 84000
#define PLRAM_BANK2_SIZE 84000
#define PLRAM_BANK3_SIZE 84000

#define VECTOR_SIZE_PLRAM_BANK_0 12
#define VECTOR_SIZE_PLRAM_BANK_1 12
#define VECTOR_SIZE_PLRAM_BANK_2 12
#define VECTOR_SIZE_PLRAM_BANK_3 12

#define VECTOR_START_IDX_PLRAM_BANK_0 304
#define VECTOR_START_IDX_PLRAM_BANK_1 316
#define VECTOR_START_IDX_PLRAM_BANK_2 328
#define VECTOR_START_IDX_PLRAM_BANK_3 340

//////////////////////////////   TEMPLATE END  //////////////////////////////

typedef ap_int<AXI_WIDTH_HBM> t_hbm;
typedef ap_int<AXI_WIDTH_DDR> t_ddr;
typedef ap_int<AXI_WIDTH_PLRAM> t_plram;

typedef int D_TYPE;
typedef ap_int<128> W_TYPE;  // weights / feature width
// typedef ap_int<256> FIFO_TYPE;  // stream width

#define INTS_PER_W 4 // 64 bit = 2 x 32 bit int
// #define INTS_PER_FIFO 8

#define INPUT_SIZE 352
#define HIDDEN_SIZE1 1024
#define HIDDEN_SIZE2 512
#define HIDDEN_SIZE3 256
#define OUTPUT_SIZE 1

#define PE_NUM1 128
#define PE_NUM2 128
#define PE_NUM3 32
#define PE_NUM_OUT 1

// This row means after transpose it is row, before is col
#define ROW_PER_PE1 (HIDDEN_SIZE1 / PE_NUM1) // 1024 / 128 = 8
#define ROW_PER_PE2 (HIDDEN_SIZE2 / PE_NUM2) // 512 / 128 = 4
#define ROW_PER_PE3 (HIDDEN_SIZE3 / PE_NUM3) // 256 / 32 = 8
#define ROW_PER_PE_OUT (OUTPUT_SIZE / PE_NUM_OUT) // 1 / 1 = 1

#define FIFO_BATCH_SIZE 8   // cache 2 batches at max in FIFO
#define BATCH_SIZE 32
#define BATCH_NUM 1000000
// #define BATCH_NUM 2
// #define BATCH_NUM 1
// #define BATCH_NUM 5000 // NOTE! load access idx to BRAM!
